$(document).ready(function(){y()});window.onload=()=>{$("#onload").modal("show")};$("#onload").on("shown.bs.modal",function(){$("#active_chapter_check").focus()});$(document).on("shown.bs.modal","#modal",function(){var d=$(document).find("#modal").find(".signature");d.signature({background:"#fdd700",color:"#000000",thickness:3}),d.signature({syncField:"#signatureJSON"})});$(document).on("change",".field_monitor",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var d=$(this).closest("form.ajax_form").attr("id"),e=$(this).attr("name"),n=$(this).val(),l=$(this).data();e=="country"&&(n=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var s="field_monitor",f=c({action:s,form_id:d,field_name:e,field_value:n,field_data:l});$.when(f).done(function(g){console.log("Ajax Action Done"),console.log(g.data);var p=$(document).find(".field_monitor[name='region']"),m=$(document).find(".field_monitor[name='province']"),v=$(document).find(".field_monitor[name='city']");e=="country"&&(p.empty(),m.empty(),v.empty(),p.append("<option>--</option>"),$.each(g.data.regions,function(h,u){p.append("<option value='"+u.region+"'>"+u.region+"</option>")})),e=="region"&&(m.empty(),v.empty(),m.append("<option>--</option>"),$.each(g.data.provinces,function(h,u){m.append("<option value='"+u.province+"'>"+u.province+"</option>")})),e=="province"&&(v.empty(),v.append("<option>--</option>"),$.each(g.data.cities,function(h,u){v.append("<option value='"+u.lgu+"'>"+u.lgu+"</option>")}))})});$(document).on("change",".field_monitor_multi",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var d=$(this).closest("form.ajax_form").attr("id"),e=$(this).attr("name"),n=$(this).val(),l=$(this).attr("data-fieldgroup_id"),s=$(this).attr("data-fieldgroup_name");e=="country"&&(n=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var f="field_monitor_multi",g=c({action:f,form_id:d,field_name:e,field_value:n,field_group_id:l,field_group:s});$.when(g).done(function(){console.log("Ajax Action Done")})});$(document).on("click",".ajax_btn",function(d){d.preventDefault();var e=$(this),n=e.data(),l=$(document).find(".ajax_form").attr("id");switch(console.log(e),console.log(n),$(this).data("action")){case"affix-signature":$(document).find("#modal").modal("show"),$(document).find("#modal").find(".ajax_btn[data-action='set-signature']").attr("data-signbox",e.data("signbox"));break;case"clear-signature":e.parent().find(".signature").signature("clear");break;case"set-signature":var s=$(this).attr("data-signbox");console.log(s);var f=$(document).find("#modal").find(".signature").find("canvas").width(),g=$(document).find("#modal").find(".signature").find("canvas").height(),p=e.parent().parent().find("#signatureJSON").val(),m=$(document).find(".signature[data-signbox='"+s+"']"),h=$(document).find(".signature_box[data-signbox='"+s+"']"),v=$(document).find(".field_monitor_multi[data-signbox='"+s+"']");v.text(p).change(),h.removeClass("d-none"),m.css("width",f),m.css("height",g),m.signature({background:"#fdd700",color:"#000000",thickness:3}),m.signature("enable").signature("draw",p).signature("disable"),$(document).find("#modal").modal("hide");break;case"fieldgroup-add":var h=$(this).closest(".row").closest(".row"),u=h.find(".fieldgroup_box[data-fieldgroup_id='0']"),_=$(this).data("fieldgroup_name"),t={action:"fieldgroup_add",form_id:l,fieldgroup_name:_},o=c(t);$.when(o).done(function(a){h.prepend('<div class="fieldgroup_box row p-0 m-0" data-fieldgroup_name="'+_+'" data-fieldgroup_id="'+a+'" >'+u.html()+'<div class="col-12 py-0 pe-3 mb-1 d-flex flex-row-reverse"><button  style="margin-top: -10px;" class="py-0 btn-danger btn btn-sm ajax_btn" data-action="fieldgroup_remove" data-fieldgroup_name="'+_+'" data-fieldgroup_id="'+a+'" >remove</button></div></div>'),h.find(".fieldgroup_box[data-fieldgroup_id='"+a+"']").find(".form-control").attr("data-fieldgroup_id",a)});break;case"active_chapter_check":let b=$(document).find("input#active_chapter_check"),w=b.val();b.attr("disabled",!0);var t={action:"active_chapter_check",active_chapter:w},o=c(t);$.when(o).done(function(a){b.attr("disabled",!1),a.error==!1?(console.log(a.data),$(document).find("#onload").modal("hide"),$(document).find("input[name='chapter_name']").val(a.data.chapter_name).change(),$(document).find("input[name='chapter_serial_number']").val(a.data.chapter_serial_number).change(),$(document).find("select[name='chapter_category']").val(a.data.chapter_type.charAt(0).toUpperCase()+a.data.chapter_type.slice(1)).change()):console.log(a.message)});break;case"active_lady_chapter_check":let k=$(document).find("input#active_chapter_check"),x=k.val();k.attr("disabled",!0);var t={action:"active_lady_chapter_check",active_lady_chapter_check:x},o=c(t);$.when(o).done(function(a){k.attr("disabled",!1),console.log(o)});break;case"triskelion-registration-continue":$(document).find("#confirm_registration").modal("show");break;case"triskelion-registration-confirm":var r=e.text(),i=e.css("background-color"),t={action:"triskelion_registration_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"lady-triskelion-registration-continue":$(document).find("#confirm_registration").modal("show");break;case"lady-triskelion-registration-confirm":var r=e.text(),i=e.css("background-color"),t={action:"lady_triskelion_registration_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):(alert("Error encountered"),e.removeAttr("disabled"),e.css("background-color",i),e.text(r))});break;case"neophyte-application-continue":$(document).find("#confirm_registration").modal("show");break;case"neophyte-application-confirm":var r=e.text(),i=e.css("background-color"),t={action:"neophyte_application_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"chapter-history-continue":$(document).find("#confirm_registration").modal("show");break;case"chapter-history-confirm":var r=e.text(),i=e.css("background-color"),t={action:"chapter_history_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"chapter-registration-continue":$(document).find("#confirm_registration").modal("show");break;case"chapter-registration-confirm":var r=e.text(),i=e.css("background-color"),t={action:"chapter_registration_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"tgs-chapter-registration-continue":$(document).find("#confirm_registration").modal("show");break;case"tgs-chapter-registration-confirm":var r=e.text(),i=e.css("background-color"),t={action:"tgs_chapter_registration_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"new-chapter-application-continue":$(document).find("#confirm_registration").modal("show");break;case"new-chapter-application-confirm":var r=e.text(),i=e.css("background-color"),t={action:"new_chapter_application_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;case"delegate-chapter-continue":$(document).find("#delegate_modal").modal("show");break;case"council-registration-continue":$(document).find("#confirm_registration").modal("show");break;case"council-registration-confirm":var r=e.text(),i=e.css("background-color"),t={action:"council_registration_confirm"},o=c(t);e.attr("disabled","disabled"),e.text("Please wait..."),$.when(o).done(function(a){a.error==!1?(console.log(a),e.removeAttr("disabled"),e.css("background-color",i),e.text(r),location.reload()):alert("Error encountered")});break;default:var o=c(n);break}});function c(d,e){var n=new $.Deferred;return $.ajax({url:"/ajax",method:"POST",data:d,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},beforeSend:function(){},success:function(l){n.resolve(l)},complete:function(){},error:function(){n.fail("Error in Ajax Call")}}),n.promise()}function y(){var d=$(document).find(".ajax_form").find(".signature_box");$.each(d,function(e,n){var l=$(n).attr("data-signbox"),s=$(n).find("textarea[data-signbox='"+l+"']");$(n).removeClass("d-none");var f=$(n).find(".signature[data-signbox='"+l+"']");s.val().length>0&&(f.css("height",200),f.css("width","60%"),f.signature({background:"#fdd700",color:"#000000",thickness:3}).signature("disable"),f.signature("enable").signature("draw",s.val()).signature("disable"))})}
