$(document).on("shown.bs.modal","#modal",function(){var n=$(document).find("#modal").find(".signature");n.signature({background:"#fdd700",color:"#000000",thickness:3}),n.signature({syncField:"#signatureJSON"})});$(document).on("change",".field_monitor",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var n=$(this).closest("form.ajax_form").attr("id"),a=$(this).attr("name"),e=$(this).val(),t=$(this).data();a=="country"&&(e=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var o="field_monitor",i=l({action:o,form_id:n,field_name:a,field_value:e,field_data:t});$.when(i).done(function(){console.log("Ajax Action Done")})});$(document).on("change",".field_monitor_multi",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var n=$(this).closest("form.ajax_form").attr("id"),a=$(this).attr("name"),e=$(this).val(),t=$(this).attr("data-fieldgroup_id"),o=$(this).attr("data-fieldgroup_name");a=="country"&&(e=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var i="field_monitor_multi",f=l({action:i,form_id:n,field_name:a,field_value:e,field_group_id:t,field_group:o});$.when(f).done(function(){console.log("Ajax Action Done")})});$(document).on("click",".ajax_btn",function(n){n.preventDefault();var a=$(this),e=a.data(),t=$(document).find(".ajax_form").attr("id");switch(console.log(a),console.log(e),$(this).data("action")){case"affix-signature":$(document).find("#modal").modal("show"),$(document).find("#modal").find(".ajax_btn[data-action='set-signature']").attr("data-signbox",a.data("signbox"));break;case"clear-signature":a.parent().find(".signature").signature("clear");break;case"set-signature":var o=$(this).attr("data-signbox");console.log(o);var i=$(document).find("#modal").find(".signature").find("canvas").width(),f=$(document).find("#modal").find(".signature").find("canvas").height(),m=a.parent().parent().find("#signatureJSON").val(),r=$(document).find(".signature[data-signbox='"+o+"']"),d=$(document).find(".signature_box[data-signbox='"+o+"']"),g=$(document).find(".field_monitor_multi[data-signbox='"+o+"']");g.text(m).change(),d.removeClass("d-none"),r.css("width",i),r.css("height",f),r.signature({background:"#fdd700",color:"#000000",thickness:3}),r.signature("enable").signature("draw",m).signature("disable"),$(document).find("#modal").modal("hide");break;case"fieldgroup-add":var d=$(this).closest(".row").closest(".row"),v=d.find(".fieldgroup_box[data-fieldgroup_id='0']"),c=$(this).data("fieldgroup_name"),_={action:"fieldgroup_add",form_id:t,fieldgroup_name:c},u=l(_);$.when(u).done(function(s){d.prepend('<div class="fieldgroup_box row p-0 m-0" data-fieldgroup_name="'+c+'" data-fieldgroup_id="'+s+'" >'+v.html()+'<div class="col-12 py-0 pe-3 mb-1 d-flex flex-row-reverse"><button  style="margin-top: -10px;" class="py-0 btn-danger btn btn-sm ajax_btn" data-action="fieldgroup_remove" data-fieldgroup_name="'+c+'" data-fieldgroup_id="'+s+'" >remove</button></div></div>'),d.find(".fieldgroup_box[data-fieldgroup_id='"+s+"']").find(".form-control").attr("data-fieldgroup_id",s)});break;default:var u=l(e)}});function l(n,a){var e=new $.Deferred;return $.ajax({url:"/ajax",method:"POST",data:n,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},beforeSend:function(){},success:function(t){e.resolve(t)},complete:function(){},error:function(){e.fail("Error in Ajax Call")}}),e.promise()}
