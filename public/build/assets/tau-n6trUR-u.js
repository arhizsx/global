$(document).ready(function(){_()});$(document).on("shown.bs.modal","#modal",function(){var n=$(document).find("#modal").find(".signature");n.signature({background:"#fdd700",color:"#000000",thickness:3}),n.signature({syncField:"#signatureJSON"})});$(document).on("change",".field_monitor",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var n=$(this).closest("form.ajax_form").attr("id"),e=$(this).attr("name"),a=$(this).val(),t=$(this).data();e=="country"&&(a=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var o="field_monitor",i=l({action:o,form_id:n,field_name:e,field_value:a,field_data:t});$.when(i).done(function(){console.log("Ajax Action Done")})});$(document).on("change",".field_monitor_multi",function(){console.log(this.value),console.log($(this).attr("name")),console.log($(this).data()),console.log($(this).closest("form.ajax_form").attr("id")),$(this);var n=$(this).closest("form.ajax_form").attr("id"),e=$(this).attr("name"),a=$(this).val(),t=$(this).attr("data-fieldgroup_id"),o=$(this).attr("data-fieldgroup_name");e=="country"&&(a=="PH"?($(this).closest(".row").find("[name='region']").parent().removeClass("d-none"),$(this).closest(".row").find("[name='province']").parent().removeClass("d-none")):($(this).closest(".row").find("[name='region']").parent().addClass("d-none"),$(this).closest(".row").find("[name='province']").parent().addClass("d-none")));var i="field_monitor_multi",f=l({action:i,form_id:n,field_name:e,field_value:a,field_group_id:t,field_group:o});$.when(f).done(function(){console.log("Ajax Action Done")})});$(document).on("click",".ajax_btn",function(n){n.preventDefault();var e=$(this),a=e.data(),t=$(document).find(".ajax_form").attr("id");switch(console.log(e),console.log(a),$(this).data("action")){case"affix-signature":$(document).find("#modal").modal("show"),$(document).find("#modal").find(".ajax_btn[data-action='set-signature']").attr("data-signbox",e.data("signbox"));break;case"clear-signature":e.parent().find(".signature").signature("clear");break;case"set-signature":var o=$(this).attr("data-signbox");console.log(o);var i=$(document).find("#modal").find(".signature").find("canvas").width(),f=$(document).find("#modal").find(".signature").find("canvas").height(),u=e.parent().parent().find("#signatureJSON").val(),r=$(document).find(".signature[data-signbox='"+o+"']"),d=$(document).find(".signature_box[data-signbox='"+o+"']"),g=$(document).find(".field_monitor_multi[data-signbox='"+o+"']");g.text(u).change(),d.removeClass("d-none"),r.css("width",i),r.css("height",f),r.signature({background:"#fdd700",color:"#000000",thickness:3}),r.signature("enable").signature("draw",u).signature("disable"),$(document).find("#modal").modal("hide");break;case"fieldgroup-add":var d=$(this).closest(".row").closest(".row"),v=d.find(".fieldgroup_box[data-fieldgroup_id='0']"),c=$(this).data("fieldgroup_name"),h={action:"fieldgroup_add",form_id:t,fieldgroup_name:c},m=l(h);$.when(m).done(function(s){d.prepend('<div class="fieldgroup_box row p-0 m-0" data-fieldgroup_name="'+c+'" data-fieldgroup_id="'+s+'" >'+v.html()+'<div class="col-12 py-0 pe-3 mb-1 d-flex flex-row-reverse"><button  style="margin-top: -10px;" class="py-0 btn-danger btn btn-sm ajax_btn" data-action="fieldgroup_remove" data-fieldgroup_name="'+c+'" data-fieldgroup_id="'+s+'" >remove</button></div></div>'),d.find(".fieldgroup_box[data-fieldgroup_id='"+s+"']").find(".form-control").attr("data-fieldgroup_id",s)});break;default:var m=l(a)}});function l(n,e){var a=new $.Deferred;return $.ajax({url:"/ajax",method:"POST",data:n,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},beforeSend:function(){},success:function(t){a.resolve(t)},complete:function(){},error:function(){a.fail("Error in Ajax Call")}}),a.promise()}function _(){var n=$(document).find(".ajax_form").find(".signature_box");$.each(n,function(e,a){var t=$(a).attr("data-signbox"),o=$(a).find("textarea[data-signbox='"+t+"']");$(a).removeClass("d-none");var i=$(a).find(".signature[data-signbox='"+t+"']");o.val().length>0&&(i.css("height",200),i.css("width","60%"),i.signature({background:"#fdd700",color:"#000000",thickness:3}).signature("disable"),i.signature("enable").signature("draw",o.val()).signature("disable"))})}
